(()=>{"use strict";function e(e,t,n,d,a,s){return{title:e,description:t,date:n,priority:d,cheked:a,id:s,isFromToday:()=>{},isFromThisWeek:()=>{},isImportant:()=>{},isCompleted:()=>{}}}function t(e,t){let n=[];const d=e=>n.find((t=>t.id===e));return{name:e,id:t,addTask:e=>{n.push(e)},getTasks:()=>n,deleteTask:e=>{n=n.filter((t=>t.id!==e))},hasTask:e=>void 0!==d(e),updateTask:(e,t)=>{let n=d(e);console.log(t),Object.assign(n,t),console.log(n)}}}const n=t("nuevo"),d=e("hola","si","ahora","1","no");n.addTask(d);const a=(e,t)=>{const n=document.getElementsByClassName("sections")[0],d=document.createElement("li"),a=document.createElement("a");a.innerText=e,a.setAttribute("href","#"),a.dataset.section=e,a.classList.add("section-link"),d.appendChild(a),d.classList.add("section"),d.addEventListener("click",(e=>{e.preventDefault(),t()})),n.appendChild(d)},s=(e,t)=>{const n=document.createElement("dialog");n.classList.add("task-dialog"),n.classList.add(t);const d=document.createElement("form"),a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("id","task-name"),a.setAttribute("name","task-name");const s=document.createElement("input");s.setAttribute("type","text"),s.setAttribute("id","task-description"),s.setAttribute("name","task-description");const c=document.createElement("input");c.setAttribute("type","date"),c.setAttribute("id","task-date"),c.setAttribute("name","task-date");const o=document.createElement("input");o.setAttribute("type","number"),o.setAttribute("id","task-priority"),o.setAttribute("name","task-priority");const i=document.createElement("input");i.setAttribute("type","checkbox"),i.setAttribute("id","task-check"),i.setAttribute("name","task-check");const l=document.createElement("button");l.classList.add("sumbit-task"),l.classList.add(t),d.appendChild(a),d.appendChild(s),d.appendChild(c),d.appendChild(o),d.appendChild(i),n.appendChild(d),d.appendChild(l),e.appendChild(n)},c=(e,t,n)=>{const d=document.getElementsByClassName("projects")[0],a=document.createElement("li"),s=document.createElement("a");s.innerText=e.name,s.setAttribute("href","#"),a.appendChild(s),a.classList.add("project"),a.dataset.id=e.id,a.addEventListener("click",(n=>{n.preventDefault(),t(e.id)}));const c=document.createElement("button");c.classList.add("delete-project-button"),c.innerText="Delete",c.addEventListener("click",(t=>{t.preventDefault(),n(t,e.id)})),a.appendChild(c),d.appendChild(a)},o=(e,t,n)=>{(e=>{const t=document.createElement("div");t.classList.add("section-conteiner");const n=document.createElement("ul");n.classList.add("sections"),t.appendChild(n),e.appendChild(t)})(e),((e,t)=>{const n=document.createElement("div");(e=>{const t=document.createElement("div");t.classList.add("projects-conteiner");const n=document.createElement("h2");n.innerText="Projects",n.classList.add("project-title"),t.appendChild(n);const d=document.createElement("button");d.classList.add("projects-add"),d.innerText="Add Project";const a=document.createElement("dialog");a.classList.add("project-dialog"),t.appendChild(a);const s=document.createElement("form"),c=document.createElement("input");c.setAttribute("type","text"),c.setAttribute("id","project"),c.setAttribute("name","Project");const o=document.createElement("button");o.classList.add("sumbit-project"),s.appendChild(c),a.appendChild(s),s.appendChild(o),t.appendChild(d),e.appendChild(t)})(n),(e=>{const t=document.createElement("ul");t.classList.add("projects"),e.appendChild(t)})(n),e.appendChild(n)})(e)},i=e=>{for(;e.firstChild;)e.removeChild(e.lastChild)},l=(e,t,n)=>{const d=document.getElementById("content");i(d),r(e,d,t,n)},r=(e,t,n,d)=>{const a=document.createElement("button");a.innerText="AddTask",a.classList.add("task-add");const c=document.createElement("div");c.classList.add("task"),c.appendChild(a),s(c),t.appendChild(c),console.log(e),e.forEach((e=>{const a=document.createElement("div");a.classList.add("task"),a.dataset.id=e.id,((e,t,n,d)=>{const{title:a,description:c,date:o,priority:i,cheked:l,id:r}=t,m=document.createElement("h3");m.classList.add("task-title"),m.innerText=a;const u=document.createElement("button");u.classList.add("edit-button"),u.innerText="Edit",u.addEventListener("click",(d=>{s(e,"edit"),console.log("here"),n(d,t)}));const p=document.createElement("button");p.classList.add("delete-task-button"),p.innerText="Delete",p.addEventListener("click",(e=>d(e,r))),e.appendChild(m),e.appendChild(u),e.appendChild(p)})(a,e,n,d),t.appendChild(a)}))},m=function(n){let d=[];const a=e=>d.find((t=>t.hasTask(e))),s=()=>Math.floor(1e6*Math.random()),c=e=>{const n=t(e,s());return d.push(n),n.id};return{createTask:(t,n,a,c,o,i)=>{const l=e(t,n,a,c,o,s());d.find((e=>e.id===i)).addTask(l)},createProject:c,updateTask:(e,t)=>{a(e).updateTask(e,t)},deleteTask:e=>{const t=a(e),n=d.indexOf(t);d[n].deleteTask(e)},deleteProject:e=>{const t=d.find((t=>t.id===e)),n=d.indexOf(t);d.splice(n,1),t.getTasks().forEach((e=>{t.deleteTask(e.id)}))},getProjects:()=>d,firstProject:()=>(d||c("My Project"),d[0]),getProjectTask:e=>{const t=d.find((t=>t.id===e));return t?t.getTasks():[]},getAllTask:()=>{let e=d.map((e=>e.getTasks()));return e?e.reduce(((e,t)=>e.concat(t))):[]}}}(),u=m.createProject("nuevo");m.createTask("tarea","1","1","1","1",u),function(e){const t=[{name:"All",handler:e=>!0},{name:"today",handler:e=>e.isFromToday()},{name:"this Week",handler:e=>e.isFromThisWeek()},{name:"Important",handler:e=>e.isImportant()},{name:"Completed",handler:e=>e.isCompleted()}],n=(d=e.getProjects(),{initialize:()=>{(e=>{const t=document.createElement("h1");t.innerText="TODO LIST",e.appendChild(t)})(document.getElementById("header"));const e=document.getElementById("sidebar");o(e);const t=document.getElementById("content");r((()=>{let e=[];return d.forEach((t=>{e=e.concat(t.getTasks())})),e})(),t)},createSection:a,createProject:c,renderContent:l,renderProjects:()=>{const e=document.getElementsByClassName("projects")[0];i(e)}});var d;let s=e.firstProject(),m=s.getTasks(),u=!1;n.initialize();const p=e=>{m=e(),k()};t.forEach((t=>{n.createSection(t.name,(()=>{p((()=>(u=!0,e.getAllTask().filter((e=>t.handler(e))))))}))}));const k=()=>{n.renderProjects(),e.getProjects().forEach((t=>{n.createProject(t,(t=>{p((()=>(u=!1,e.getProjectTask(t))))}),((e,t)=>E(e,t)))})),console.log(m),n.renderContent(m,C,g),document.getElementsByClassName("task-add")[0].addEventListener("click",h)},h=t=>{if(t.preventDefault(),u)return void alert("You Have to be in an Project to add a Task");const n=document.getElementsByClassName("task-dialog")[0];n.showModal(),document.getElementsByClassName("sumbit-task")[0].addEventListener("click",(()=>{const t=document.getElementById("task-name").value,d=document.getElementById("task-description").value,a=document.getElementById("task-date").value,c=document.getElementById("task-priority").value,o=document.getElementById("task-check").value;e.createTask(t,d,a,c,o,s.id),n.close(),k()}))},E=(t,n)=>{t.preventDefault(),e.deleteProject(n),s.id===n&&(m=[]),k()},g=(t,n)=>{t.preventDefault(),e.deleteTask(n),m=s.getTasks(),k()},C=(t,n)=>{t.preventDefault();const d=document.getElementsByClassName("edit")[0];document.getElementsByClassName("edit")[1].addEventListener("click",(()=>{const t=document.getElementById("task-name").value,a=document.getElementById("task-description").value,c=document.getElementById("task-date").value,o=document.getElementById("task-priority").value,i=document.getElementById("task-check").value;console.log("the section to render is"+s.id),e.updateTask(n.id,{title:t,description:a,date:c,priority:o,cheked:i}),d.close(),k()})),d.showModal(),m=s.getTasks()};document.getElementsByClassName("projects-add")[0].addEventListener("click",(t=>{t.preventDefault();const n=document.getElementsByClassName("project-dialog")[0];n.showModal(),document.getElementsByClassName("sumbit-project")[0].addEventListener("click",(()=>{const t=document.getElementById("project").value;e.createProject(t),n.close(),k()}))})),k()}(m)})();